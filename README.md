# Keepa Excel結合ツール

複数の `keepa-*.xlsx` ファイルをASIN列付きで縦結合し、CSVとして出力するStreamlitアプリです。

## 機能

- **複数Excelファイルの縦結合**: keepa形式のExcelファイルを一括処理
- **ASIN列の自動追加**: シート名から自動的にASINを抽出し、A列に追加
- **2つの入力モード**:
  - フォルダ指定: ローカルフォルダから `keepa-*.xlsx` を自動検出
  - ファイルアップロード: ブラウザから直接アップロード（複数選択可）
- **プレビュー機能**: 結合結果を確認してからダウンロード
- **CSVエクスポート**: タイムスタンプ付きファイル名で出力

## ローカル実行

```bash
# 依存関係インストール
pip install -r requirements.txt

# アプリ起動
streamlit run app.py
```

ブラウザで `http://localhost:8501` が自動的に開きます。

## 使い方

### フォルダ指定モード
1. フォルダパスを入力（デフォルト: `C:\Users\野川悠悟\Downloads`）
2. 「ファイル検出」ボタンをクリック
3. 検出されたファイル一覧を確認
4. 「結合実行」で処理開始

### ファイルアップロードモード
1. 「ファイルアップロード」タブに切り替え
2. 複数の `keepa-*.xlsx` ファイルを選択
3. アップロード完了後、「結合実行」で処理開始

### 結果ダウンロード
- 結合完了後、プレビューとメトリクス（総行数・ASIN数・カラム数）が表示されます
- 「CSVダウンロード」ボタンでファイルを取得

## 必要なファイル形式

- ファイル名: `keepa-*.xlsx` （例: `keepa-B0ABCDEFGH.xlsx`）
- シート構成:
  - ASIN名のシート（例: `B0ABCDEFGH`）← ここからデータを取得
  - `Note` シート（無視されます）

## デプロイ

Streamlit Community Cloudでのデプロイ手順は[こちら](#streamlit-community-cloudデプロイ手順)を参照してください。

## ライセンス

MIT License
